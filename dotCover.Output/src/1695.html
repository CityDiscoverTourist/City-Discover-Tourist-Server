<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>D:\C#\CityDiscoverTourist\CityDiscoverTourist.Business\Helper\Entity.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System.Collections;
using System.Dynamic;
using System.Xml;
using System.Xml.Schema;
using System.Xml.Serialization;

namespace CityDiscoverTourist.Business.Helper;

public class Entity : DynamicObject, IXmlSerializable, IDictionary&lt;string, object&gt;
	{
		private readonly string _root = &quot;EntityWithLinks&quot;;
		private readonly IDictionary&lt;string, object&gt; _expando = null;

		public Entity()
		{
			_expando = new ExpandoObject();
		}

		public override bool TryGetMember(GetMemberBinder binder, out object result)
		{
			if (_expando.TryGetValue(binder.Name, out object value))
			{
				result = value;
				return true;
			}

			return base.TryGetMember(binder, out result);
		}

		public override bool TrySetMember(SetMemberBinder binder, object value)
		{
			_expando[binder.Name] = value;

			return true;
		}

		public XmlSchema GetSchema()
		{
			throw new NotImplementedException();
		}

		public void ReadXml(XmlReader reader)
		{
			reader.ReadStartElement(_root);

			while (!reader.Name.Equals(_root))
			{
				string typeContent;
				Type underlyingType;
				var name = reader.Name;

				reader.MoveToAttribute(&quot;type&quot;);
				typeContent = reader.ReadContentAsString();
				underlyingType = Type.GetType(typeContent);
				reader.MoveToContent();
				_expando[name] = reader.ReadElementContentAs(underlyingType, null);
			}
		}

		public void WriteXml(XmlWriter writer)
		{
			foreach (var key in _expando.Keys)
			{
				var value = _expando[key];
				WriteLinksToXml(key, value, writer);
			}
		}

		private void WriteLinksToXml(string key, object value, XmlWriter writer)
		{
			writer.WriteStartElement(key);
			writer.WriteString(value.ToString());
			writer.WriteEndElement();
		}

		public void Add(string key, object value)
		{
			_expando.Add(key, value);
		}

		public bool ContainsKey(string key)
		{
			return _expando.ContainsKey(key);
		}

		public ICollection&lt;string&gt; Keys
		{
			get { return _expando.Keys; }
		}

		public bool Remove(string key)
		{
			return _expando.Remove(key);
		}

		public bool TryGetValue(string key, out object value)
		{
			return _expando.TryGetValue(key, out value);
		}

		public ICollection&lt;object&gt; Values
		{
			get { return _expando.Values; }
		}

		public object this[string key]
		{
			get
			{
				return _expando[key];
			}
			set
			{
				_expando[key] = value;
			}
		}

		public void Add(KeyValuePair&lt;string, object&gt; item)
		{
			_expando.Add(item);
		}

		public void Clear()
		{
			_expando.Clear();
		}

		public bool Contains(KeyValuePair&lt;string, object&gt; item)
		{
			return _expando.Contains(item);
		}

		public void CopyTo(KeyValuePair&lt;string, object&gt;[] array, int arrayIndex)
		{
			_expando.CopyTo(array, arrayIndex);
		}

		public int Count
		{
			get { return _expando.Count; }
		}

		public bool IsReadOnly
		{
			get { return _expando.IsReadOnly; }
		}

		public bool Remove(KeyValuePair&lt;string, object&gt; item)
		{
			return _expando.Remove(item);
		}

		public IEnumerator&lt;KeyValuePair&lt;string, object&gt;&gt; GetEnumerator()
		{
			return _expando.GetEnumerator();
		}

		IEnumerator IEnumerable.GetEnumerator()
		{
			return GetEnumerator();
		}
	}
    </pre>
    <script type="text/javascript">
      highlightRanges([[11,3,11,53,0],[12,3,12,64,0],[14,3,14,18,0],[15,3,15,4,0],[16,4,16,35,0],[17,3,17,4,0],[20,3,20,4,0],[21,4,21,60,0],[22,4,22,5,0],[23,5,23,20,0],[24,5,24,17,0],[27,4,27,49,0],[28,3,28,4,0],[31,3,31,4,0],[32,4,32,34,0],[34,4,34,16,0],[35,3,35,4,0],[38,3,38,4,0],[39,4,39,40,0],[43,3,43,4,0],[44,4,44,35,0],[46,4,46,38,0],[47,4,47,5,0],[50,5,50,28,0],[52,5,52,36,0],[53,5,53,48,0],[54,5,54,48,0],[55,5,55,28,0],[56,5,56,72,0],[57,4,57,5,0],[58,3,58,4,0],[61,3,61,4,0],[62,4,62,11,0],[62,13,62,20,0],[62,21,62,23,0],[62,24,62,37,0],[63,4,63,5,0],[64,5,64,31,0],[65,5,65,41,0],[66,4,66,5,0],[67,3,67,4,0],[70,3,70,4,0],[71,4,71,34,0],[72,4,72,41,0],[73,4,73,29,0],[74,3,74,4,0],[77,3,77,4,0],[78,4,78,29,0],[79,3,79,4,0],[82,3,82,4,0],[83,4,83,37,0],[84,3,84,4,0],[88,8,88,9,0],[88,10,88,31,0],[88,32,88,33,0],[92,3,92,4,0],[93,4,93,32,0],[94,3,94,4,0],[97,3,97,4,0],[98,4,98,48,0],[99,3,99,4,0],[103,8,103,9,0],[103,10,103,33,0],[103,34,103,35,0],[109,4,109,5,0],[110,5,110,26,0],[111,4,111,5,0],[113,4,113,5,0],[114,5,114,27,0],[115,4,115,5,0],[119,3,119,4,0],[120,4,120,23,0],[121,3,121,4,0],[124,3,124,4,0],[125,4,125,21,0],[126,3,126,4,0],[129,3,129,4,0],[130,4,130,35,0],[131,3,131,4,0],[134,3,134,4,0],[135,4,135,39,0],[136,3,136,4,0],[140,8,140,9,0],[140,10,140,32,0],[140,33,140,34,0],[145,8,145,9,0],[145,10,145,37,0],[145,38,145,39,0],[149,3,149,4,0],[150,4,150,33,0],[151,3,151,4,0],[154,3,154,4,0],[155,4,155,36,0],[156,3,156,4,0],[159,3,159,4,0],[160,4,160,27,0],[161,3,161,4,0]]);
    </script>
  </body>
</html>