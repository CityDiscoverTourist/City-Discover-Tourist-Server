<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>D:\C#\CityDiscoverTourist\CityDiscoverTourist.API\Config\ConfigController.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System.Globalization;
using System.Text.RegularExpressions;
using CityDiscoverTourist.Business.Helper;
using CityDiscoverTourist.Business.IServices;
using CityDiscoverTourist.Business.IServices.Services;
using CityDiscoverTourist.Data.IRepositories;
using CityDiscoverTourist.Data.IRepositories.Repositories;
using CityDiscoverTourist.Data.Models;
using Microsoft.AspNetCore.Authentication.JwtBearer;
using Microsoft.AspNetCore.Mvc.ApplicationModels;
using Microsoft.OpenApi.Models;
using Task = CityDiscoverTourist.Data.Models.Task;

namespace CityDiscoverTourist.API.Config;

/// &lt;summary&gt;
///
/// &lt;/summary&gt;
public static class ConfigController
{
    public static void SetupServices(this IServiceCollection services)
    {
        services.AddScoped&lt;IAuthService, AuthService&gt;();
        services.AddScoped&lt;IQuestService, QuestService&gt;();
        services.AddScoped&lt;IQuestTypeService, QuestTypeService&gt;();
        services.AddScoped&lt;ITaskTypeService, TaskTypeService&gt;();
        services.AddScoped&lt;ITaskService, TaskService&gt;();
        services.AddScoped&lt;IExperienceService, ExperienceService&gt;();
        services.AddScoped&lt;IRewardService, RewardService&gt;();
        services.AddScoped&lt;IFacebookService, FacebookService&gt;();
    }

    public static void SetupHelper(this IServiceCollection services)
    {
        services.AddScoped&lt;ISortHelper&lt;Quest&gt;, SortHelper&lt;Quest&gt;&gt;();
        services.AddScoped&lt;IDataShaper&lt;Quest&gt;, DataShaper&lt;Quest&gt;&gt;();
        services.AddScoped&lt;ISortHelper&lt;QuestType&gt;, SortHelper&lt;QuestType&gt;&gt;();
        services.AddScoped&lt;IDataShaper&lt;QuestType&gt;, DataShaper&lt;QuestType&gt;&gt;();
        services.AddScoped&lt;ISortHelper&lt;TaskType&gt;, SortHelper&lt;TaskType&gt;&gt;();
        services.AddScoped&lt;IDataShaper&lt;TaskType&gt;, DataShaper&lt;TaskType&gt;&gt;();
        services.AddScoped&lt;ISortHelper&lt;Task&gt;, SortHelper&lt;Task&gt;&gt;();
        services.AddScoped&lt;IDataShaper&lt;Task&gt;, DataShaper&lt;Task&gt;&gt;();
        services.AddScoped&lt;ISortHelper&lt;Reward&gt;, SortHelper&lt;Reward&gt;&gt;();
        services.AddScoped&lt;IDataShaper&lt;Reward&gt;, DataShaper&lt;Reward&gt;&gt;();
    }

    public static void SetupRepositories(this IServiceCollection services)
    {
        services.AddScoped&lt;IQuestRepository, QuestRepository&gt;();
        services.AddScoped&lt;IQuestTypeRepository, QuestTypeRepository&gt;();
        services.AddScoped&lt;ITaskRepository, TaskRepository&gt;();
        services.AddScoped&lt;ITaskTypeRepository, TaskTypeRepository&gt;();
        services.AddScoped&lt;ISuggestionRepository, SuggestionRepository&gt;();
        services.AddScoped&lt;IRewardRepository, RewardRepository&gt;();
        services.AddScoped&lt;ILocationRepository, LocationRepository&gt;();
        services.AddScoped&lt;IFeedbackRepository, FeedbackRepository&gt;();
        services.AddScoped&lt;IExperienceRepository, ExperienceRepository&gt;();
        services.AddScoped&lt;IContactRepository, ContactRepository&gt;();
        services.AddScoped&lt;IAnswerRepository, AnswerRepository&gt;();
    }

    public static void SetupSwagger(this IServiceCollection services, IConfiguration configuration)
    {
        services.AddSwaggerGen();
        services.AddSwaggerGen(c =&gt;
        {
            c.SwaggerDoc(&quot;v1&quot;, new OpenApiInfo { Title = &quot;City Tourist&quot;, Version = &quot;v1&quot; });
        });

        services.AddSwaggerGen(setup =&gt;
        {
            // Include &#39;SecurityScheme&#39; to use JWT Authentication
            var jwtSecurityScheme = new OpenApiSecurityScheme
            {
                Scheme = &quot;bearer&quot;,
                BearerFormat = &quot;JWT&quot;,
                Name = &quot;JWT Authentication&quot;,
                In = ParameterLocation.Header,
                Type = SecuritySchemeType.Http,
                Description = &quot;Put **_ONLY_** your JWT Bearer token on textbox below!&quot;,

                Reference = new OpenApiReference
                {
                    Id = JwtBearerDefaults.AuthenticationScheme,
                    Type = ReferenceType.SecurityScheme
                }
            };

            setup.AddSecurityDefinition(jwtSecurityScheme.Reference.Id, jwtSecurityScheme);

            setup.AddSecurityRequirement(new OpenApiSecurityRequirement
            {
                { jwtSecurityScheme, Array.Empty&lt;string&gt;() }
            });
        });

        services.AddApiVersioning(options =&gt;
        {
            // reporting api versions will return the headers &quot;api-supported-versions&quot; and &quot;api-deprecated-versions&quot;
            options.ReportApiVersions = true;
        });
        services.AddVersionedApiExplorer(options =&gt;
        {
            // add the versioned api explorer, which also adds IApiVersionDescriptionProvider service
            options.GroupNameFormat = &quot;&#39;v&#39;VVV&quot;;

            // note: this option is only necessary when versioning by url segment. the SubstitutionFormat
            // can also be used to control the format of the API version in route templates
            options.SubstituteApiVersionInUrl = true;
        });

        services.AddControllers(options =&gt;
        {
            options.Conventions.Add(new RouteTokenTransformerConvention(new LowercaseDashedParameterTransformer()));
        }).AddNewtonsoftJson(options =&gt;
            {
                options.SerializerSettings.ReferenceLoopHandling = Newtonsoft.Json.ReferenceLoopHandling.Ignore;
                options.SerializerSettings.NullValueHandling = Newtonsoft.Json.NullValueHandling.Ignore;
            }
        );
    }

    internal class LowercaseDashedParameterTransformer : IOutboundParameterTransformer
    {
        public string TransformOutbound(object? value)
        {
            // Slugify value
            return Regex.Replace(value?.ToString() ?? string.Empty, &quot;([a-z])([A-Z])&quot;, &quot;$1-$2&quot;).ToLower(new CultureInfo(&quot;en&quot;, false));
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[22,5,22,6,0],[23,9,23,57,0],[24,9,24,59,0],[25,9,25,67,0],[26,9,26,65,0],[27,9,27,57,0],[28,9,28,69,0],[29,9,29,61,0],[30,9,30,65,0],[31,5,31,6,0],[34,5,34,6,0],[35,9,35,69,0],[36,9,36,69,0],[37,9,37,77,0],[38,9,38,77,0],[39,9,39,75,0],[40,9,40,75,0],[41,9,41,67,0],[42,9,42,67,0],[43,9,43,71,0],[44,9,44,71,0],[45,5,45,6,0],[48,5,48,6,0],[49,9,49,65,0],[50,9,50,73,0],[51,9,51,63,0],[52,9,52,71,0],[53,9,53,75,0],[54,9,54,67,0],[55,9,55,71,0],[56,9,56,71,0],[57,9,57,75,0],[58,9,58,69,0],[59,9,59,67,0],[60,5,60,6,0],[63,5,63,6,0],[64,9,64,34,0],[65,9,66,9,0],[66,9,66,10,0],[66,10,67,13,0],[67,13,67,92,0],[67,92,68,9,0],[68,9,68,10,0],[68,10,68,12,0],[70,9,71,9,0],[71,9,71,10,0],[71,10,73,13,0],[73,13,87,15,0],[87,15,89,13,0],[89,13,89,92,0],[89,92,91,13,0],[91,13,94,16,0],[94,16,95,9,0],[95,9,95,10,0],[95,10,95,12,0],[97,9,98,9,0],[98,9,98,10,0],[98,10,100,13,0],[100,13,100,46,0],[100,46,101,9,0],[101,9,101,10,0],[101,10,101,12,0],[102,9,103,9,0],[103,9,103,10,0],[103,10,105,13,0],[105,13,105,48,0],[105,48,109,13,0],[109,13,109,54,0],[109,54,110,9,0],[110,9,110,10,0],[110,10,110,12,0],[112,9,113,9,0],[113,9,113,10,0],[113,10,114,13,0],[114,13,114,117,0],[114,117,115,9,0],[115,9,115,10,0],[115,10,116,13,0],[116,13,116,14,0],[116,14,117,17,0],[117,17,117,113,0],[117,113,118,17,0],[118,17,118,105,0],[118,105,119,13,0],[119,13,119,14,0],[119,14,120,11,0],[121,5,121,6,0],[126,9,126,10,0],[128,13,128,134,0],[129,9,129,10,0]]);
    </script>
  </body>
</html>